

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Sudoku Android &mdash; EmbASP 7.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Transitive Closure Datalog C#" href="transitive-closure-datalog-csharp.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> EmbASP
          

          
          </a>

          
            
            
              <div class="version">
                7.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../documentation/java-implementation.html">Java implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../documentation/python-implementation.html">Python implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../documentation/csharp-implementation.html">C# implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../documentation/technical_doc.html">Technical documentation</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="shortest-path-asp-java.html">Shortest-path ASP Java</a></li>
<li class="toctree-l1"><a class="reference internal" href="shortest-path-asp-python.html">Shortest-path ASP Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="shortest-path-asp-csharp.html">Shortest-path ASP C#</a></li>
<li class="toctree-l1"><a class="reference internal" href="blocks-world-pddl-java.html">Blocks-world PDDL Java</a></li>
<li class="toctree-l1"><a class="reference internal" href="blocks-world-pddl-python.html">Blocks-world PDDL Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="blocks-world-pddl-csharp.html">Blocks-world PDDL C#</a></li>
<li class="toctree-l1"><a class="reference internal" href="transitive-closure-datalog-java.html">Transitive Closure Datalog Java</a></li>
<li class="toctree-l1"><a class="reference internal" href="transitive-closure-datalog-python.html">Transitive Closure Datalog Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="transitive-closure-datalog-csharp.html">Transitive Closure Datalog C#</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Sudoku Android</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#getting-started">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-embasp">Using EmbASP</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">EmbASP</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Sudoku Android</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/examples/sudoku-android.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="sudoku-android">
<h1>Sudoku Android<a class="headerlink" href="#sudoku-android" title="Permalink to this headline">¶</a></h1>
<div class="section" id="getting-started">
<h2>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>In order to use the framework in your applications you have to import it as module on Android Studio</p>
<ol class="arabic simple">
<li><p>Import the framework module:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>Download the framework last released module.</p></li>
<li><p>In the project view, right-click on your project New &gt; Module.</p></li>
<li><p>Select Import .JAR/.AAR Package.</p></li>
<li><p>Select the directory in which the module has been downloaded.</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Set the dependency:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>In the Android Studio menu: File &gt; Project Structure .</p></li>
<li><p>Select your project module (by default called app).</p></li>
<li><p>In the Dependencies Tab add as Module Dependency the previously imported framework.</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="using-embasp">
<h2>Using EmbASP<a class="headerlink" href="#using-embasp" title="Permalink to this headline">¶</a></h2>
<p>In the following, we describe an actual usage of the framework by means of a running example;
as a use case, we will develop a simple Android application for solving Sudoku puzzles.</p>
<p>The complete code of this example is freely available <a class="reference external" href="https://www.mat.unical.it/calimeri/projects/embasp/files/EmbASP_Android_Sudoku.zip">here</a>.</p>
<p>The framework features a annotation-guided mapping, offered by the <a class="reference external" href="../_static/doxygen/java/classit_1_1unical_1_1mat_1_1embasp_1_1languages_1_1asp_1_1ASPMapper.html"><code class="docutils literal notranslate"><span class="pre">ASPMapper</span></code></a> component, for two-way translations between strings recognizable by ASP solvers and objects in the programming language at hand, directly employable within applications.
By means of this feature, the ASP-based aspects can be separated from the Java coding: the programmer doesn’t even necessarily need to be aware of ASP.</p>
<p>Let us think of a user that designed (or has been given) a proper logic program P to solve a sudoku puzzle and has also an initial schema.
We assume that the initial schema is well-formed i.e. the complete schema solution exists and is unique.
A possible program P is embedded in the complete example, that, coupled with a set of facts F representing the given initial schema, allows to obtain the only admissible solution.</p>
<p>By means of the annotation-guided mapping, the initial schema can be expressed in forms of Java objects.
To this extent, we define the class <code class="docutils literal notranslate"><span class="pre">Cell</span></code>, aimed at representing the single cell of the sudoku schema, as follows:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@Id</span><span class="p">(</span><span class="s">&quot;cell&quot;</span><span class="p">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Cell</span> <span class="p">{</span>

  <span class="nd">@Param</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
  <span class="kd">private</span> <span class="kt">int</span> <span class="n">row</span><span class="p">;</span>

  <span class="nd">@Param</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="kd">private</span> <span class="kt">int</span> <span class="n">column</span><span class="p">;</span>

  <span class="nd">@Param</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
  <span class="kd">private</span> <span class="kt">int</span> <span class="n">value</span><span class="p">;</span>

  <span class="o">[</span><span class="p">...</span><span class="o">]</span>

<span class="p">}</span>
</pre></div>
</div>
<p>It is worth noticing how the class has been annotated by two custom annotations, defined according to the following syntax:</p>
<ul class="simple">
<li><p><em>&#64;Id(string_name)</em> : the target must be a class, and defines the predicate name the class is mapped to;</p></li>
<li><p><em>&#64;Param(integer_position)</em> : the target must be a field of a class annotated via <em>&#64;Id</em>, and defines the term (and its position) in the ASP atom the field is mapped to.</p></li>
</ul>
<p>Thanks to these annotations the <a class="reference external" href="../_static/doxygen/java/classit_1_1unical_1_1mat_1_1embasp_1_1languages_1_1asp_1_1ASPMapper.html"><code class="docutils literal notranslate"><span class="pre">ASPMapper</span></code></a> class will be able to map <code class="docutils literal notranslate"><span class="pre">Cell</span></code> objects into strings properly recognizable from the ASP solver as logic facts of the form <em>cell(Row,Column,Value)</em>.
At this point, we can create an <a class="reference external" href="https://developer.android.com/reference/android/app/Activity.html">Android Activity Component</a> , and start deploying our sudoku application:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainActivity</span> <span class="kd">extends</span> <span class="n">AppCompatActivity</span> <span class="p">{</span>

  <span class="o">[</span><span class="p">...</span><span class="o">]</span>

  <span class="kd">private</span> <span class="n">Handler</span> <span class="n">handler</span><span class="p">;</span>

  <span class="nd">@Override</span>
  <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="p">(</span><span class="n">Bundle</span> <span class="n">bundle</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">handler</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AndroidHandler</span><span class="p">(</span><span class="n">getApplicationContext</span><span class="p">(),</span> <span class="n">DLVAndroidService</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
    <span class="o">[</span><span class="p">...</span><span class="o">]</span>
  <span class="p">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="p">(</span><span class="kd">final</span> <span class="n">View</span> <span class="n">view</span><span class="p">){</span>
    <span class="n">startReasoning</span><span class="p">();</span>
    <span class="o">[</span><span class="p">...</span><span class="o">]</span>
  <span class="p">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">startReasoning</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">InputProgram</span> <span class="n">inputProgram</span> <span class="o">=</span> <span class="k">new</span> <span class="n">InputProgram</span><span class="p">();</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
      <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
        <span class="k">try</span> <span class="p">{</span>
          <span class="k">if</span><span class="p">(</span><span class="n">sudokuMatrix</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]!=</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">inputProgram</span><span class="p">.</span><span class="na">addObjectInput</span><span class="p">(</span><span class="k">new</span> <span class="n">Cell</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">sudokuMatrix</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">j</span><span class="o">]</span><span class="p">));</span>
          <span class="p">}</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
          <span class="c1">// Handle Exception</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">handler</span><span class="p">.</span><span class="na">addProgram</span><span class="p">(</span><span class="n">inputProgram</span><span class="p">);</span>

    <span class="n">String</span> <span class="n">sudokuEncoding</span> <span class="o">=</span> <span class="n">getEncodingFromResources</span><span class="p">();</span>
    <span class="n">handler</span><span class="p">.</span><span class="na">addProgram</span><span class="p">(</span><span class="k">new</span> <span class="n">InputProgram</span><span class="p">(</span><span class="n">sudokuEncoding</span><span class="p">));</span>

    <span class="n">Callback</span> <span class="n">callback</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyCallback</span><span class="p">();</span>
    <span class="n">handler</span><span class="p">.</span><span class="na">startAsync</span><span class="p">(</span><span class="n">callback</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The class contains an <a class="reference external" href="../_static/doxygen/java/classit_1_1unical_1_1mat_1_1embasp_1_1base_1_1Handler.html"><code class="docutils literal notranslate"><span class="pre">Handler</span></code></a> instance as field, that is initialized when the Activity is created as an <a class="reference external" href="../_static/doxygen/java/classit_1_1unical_1_1mat_1_1embasp_1_1platforms_1_1android_1_1AndroidHandler.html"><code class="docutils literal notranslate"><span class="pre">AndroidHandler</span></code></a>.
Required parameters include the Android Context (an Android utility, needed to start an Android Service Component) and the type of <a class="reference external" href="../_static/doxygen/java/classit_1_1unical_1_1mat_1_1embasp_1_1platforms_1_1android_1_1AndroidService.html"><code class="docutils literal notranslate"><span class="pre">AndroidService</span></code></a> to use, in our case a <a class="reference external" href="../_static/doxygen/java/classit_1_1unical_1_1mat_1_1embasp_1_1specializations_1_1dlv_1_1android_1_1DLVAndroidService.html"><code class="docutils literal notranslate"><span class="pre">DLVAndroidService</span></code></a>.</p>
<p>In addiction, in order to represent an initial sudoku schema, the class features a matrix of integers as another field where position (i,j) contains the value of cell (i,j) in the initial schema; cells initially empty are represented by positions containing zero.</p>
<p>The method startReasoning is in charge of actually managing the reasoning: in our case, it is invoked in response to a click event that is generated when the user asks for the solution.
It is firstly created an <a class="reference external" href="../_static/doxygen/java/classit_1_1unical_1_1mat_1_1embasp_1_1base_1_1InputProgram.html"><code class="docutils literal notranslate"><span class="pre">InputProgram</span></code></a> object that is filled with <code class="docutils literal notranslate"><span class="pre">Cell</span></code> objects representing the initial schema, which is then provided to the handler;
then it is provided with the sudoku encoding. It could be loaded, for instance, by means of an utility function that retrieves it from the Android Resources folder, which, within Android applications, is typically meant for containing images, sounds, files and resources in general.</p>
<p>At this point, the reasoning process can start; since for Android we provide only the asynchronous execution mode, a <a class="reference external" href="../_static/doxygen/java/interfaceit_1_1unical_1_1mat_1_1embasp_1_1base_1_1Callback.html"><code class="docutils literal notranslate"><span class="pre">Callback</span></code></a> object is in charge of fetching the output when the ASP system has done.</p>
<p>Finally, once the computation is over, from within the <em>callback</em> function the output can be retrieved directly in form of Java objects.
For instance, in our case an inner class <code class="docutils literal notranslate"><span class="pre">MyCallback</span></code> implements the interface <a class="reference external" href="../_static/doxygen/java/interfaceit_1_1unical_1_1mat_1_1embasp_1_1base_1_1Callback.html"><code class="docutils literal notranslate"><span class="pre">Callback</span></code></a>:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">private</span> <span class="kd">class</span> <span class="nc">MyCallback</span> <span class="kd">implements</span> <span class="n">Callback</span> <span class="p">{</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">callback</span><span class="p">(</span><span class="n">Output</span> <span class="n">o</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">o</span> <span class="k">instanceof</span> <span class="n">AnswerSets</span><span class="p">))</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="n">AnswerSets</span> <span class="n">answerSets</span><span class="o">=</span><span class="p">(</span><span class="n">AnswerSets</span><span class="p">)</span><span class="n">o</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">answerSets</span><span class="p">.</span><span class="na">getAnswersets</span><span class="p">().</span><span class="na">isEmpty</span><span class="p">())</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="n">AnswerSet</span> <span class="n">as</span> <span class="o">=</span> <span class="n">answerSets</span><span class="p">.</span><span class="na">getAnswersets</span><span class="p">().</span><span class="na">get</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="k">for</span><span class="p">(</span><span class="n">Object</span> <span class="n">obj</span><span class="p">:</span><span class="n">as</span><span class="p">.</span><span class="na">getAtoms</span><span class="p">())</span> <span class="p">{</span>
        <span class="n">Cell</span> <span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="n">Cell</span><span class="p">)</span> <span class="n">obj</span><span class="p">;</span>
        <span class="n">sudokuMatrix</span><span class="o">[</span><span class="n">cell</span><span class="p">.</span><span class="na">getRow</span><span class="p">()</span><span class="o">][</span><span class="n">cell</span><span class="p">.</span><span class="na">getColumn</span><span class="p">()</span><span class="o">]</span> <span class="o">=</span> <span class="n">cell</span><span class="p">.</span><span class="na">getValue</span><span class="p">();</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Handle Exception</span>
    <span class="p">}</span>
    <span class="n">displaySolution</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>For further information, contact <a class="reference external" href="mailto:embasp&#37;&#52;&#48;mat&#46;unical&#46;it">embasp<span>&#64;</span>mat<span>&#46;</span>unical<span>&#46;</span>it</a> or visit our <a class="reference external" href="https://www.mat.unical.it/calimeri/projects/embasp/">website</a>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="transitive-closure-datalog-csharp.html" class="btn btn-neutral float-left" title="Transitive Closure Datalog C#" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, DeMaCS-Unical

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>